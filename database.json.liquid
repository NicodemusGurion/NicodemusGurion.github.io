---
---
{% assign database = {} %}
{% for post in site.posts %}
  {% assign post_id = post.title | append "|" | append post.url %}
  {% assign allwords = post.contents | split: " " }
  {% words = allwords | uniq %}
  {% assign words_to_remove = "the be to of and a an in I that it for on he because if so than also" | split: " " | uniq %}
  {% assign filtered_words = words | where_exp: "word", "word | unless: words_to_remove contains word" %}
  {% for fword in filtered_words %}
    {% assign count = 0 %}
    {% for w in text | split: " " %}
      {% if w == word %}
        {% assign count = count | increment %}
      {% endif %}
    {% endfor %}
    {% assign database[fword][post_id] = count
  {% endfor %}
{% endfor %}
{
{% for word in database %}
   "{{ word | jsonify }}": {
  {% for page_id in database[word] %}
    "{{page_id | jsonify }}": {{ database[word][page_id] }}
    {%- unless forloop.last %},{% endunless -%}
  {% endfor %}
  }
  {%- unless forloop.last %},{% endunless -%}
{% endfor %}
}
